# Fix terminal colors.
# set-option -ag terminal-overrides ",xterm-256color:RGB"

# Fix neovim indent-blankline underline color.
set-option -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# Attach to an existing session instead of closing the terminal on session kill.
set-option -g detach-on-destroy off

# Enable mouse support.
set-option -g mouse on

# Start windows and panes at 1, not 0.
set-option -g base-index 1
set-option -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Status line
# {# replace_color(colors.bg1) #}
set-option -g status-style bg=#3c3836
set-option -g status-left-style bg=brightblue,fg=black,bold
set-option -g status-left-length 25
set-option -g status-left " #S "

set-option -g status-right-style bg=brightcyan,fg=black,bold
# {# replace_color(colors.bg2) #}
set-option -g status-right "#[bg=#504945]"
# {# replace_color(colors.fg1) #}
set-option -ga status-right "#[fg=#ebdbb2,nobold] #{user} #[default] #h "

set-option -g window-status-bell-style bg=brightmagenta,fg=black
set-option -g window-status-current-format "#[bg=yellow] #I #[default] #W#{?window_zoomed_flag, ,} "
set-option -g window-status-current-style bg=brightyellow,fg=black
# {# replace_color(colors.bg2) #}
set-option -g window-status-format "#[bg=#504945]"
# {# replace_color(colors.fg1) #}
set-option -ga window-status-format "#[fg=#ebdbb2]#{?window_bell_flag,#[bg=magenta#,fg=black]} #I #[default] #W#{?window_bell_flag, } "
# {# replace_color(colors.bg1) #}
set-option -g window-status-style bg=#3c3836
# {# replace_color(colors.brightgray) #}
set-option -ga window-status-style fg=#a89984
set-option -g window-status-separator ''

# Address the problem described in this issue: https://github.com/sharkdp/bat/issues/3207
# {# replace_color(colors.bg) #}
set-option -g window-style bg=#282828

# Remap prefix to ctrl+space.
unbind C-b
set-option -g prefix C-Space
bind C-Space send-prefix

# Shift Alt vim keys to switch windows.
bind -n M-H previous-window
bind -n M-L next-window

bind o run-shell "~/bin/sessionizer"

# Plugins.
set-option -g @plugin "tmux-plugins/tpm"
set-option -g @plugin "tmux-plugins/tmux-sensible"
set-option -g @plugin "christoomey/vim-tmux-navigator"
set-option -g @plugin 'tmux-plugins/tmux-yank'

run "~/.tmux/plugins/tpm/tpm"

# Better yank keybinds
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Split panes open in the current working directory.
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
